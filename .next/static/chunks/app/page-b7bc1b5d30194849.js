(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{81:(e,t,r)=>{"use strict";r.d(t,{x:()=>s});var a=r(3345);let s=(0,a.createServerReference)("406806f09dcc4fd6dc29f0432c3612c1dd69c6dfe3",a.callServer,void 0,a.findSourceMapURL,"savePin")},350:(e,t,r)=>{"use strict";r.d(t,{t:()=>s});var a=r(3345);let s=(0,a.createServerReference)("40fcd747120242de1f8cbcda2aa39ef6327b55f509",a.callServer,void 0,a.findSourceMapURL,"deletePin")},2177:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>eW});var a=r(8081),s=r(2149),l=r(9651),o=r(9907),i=r(3484),n=r(7687);let c=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:r,variant:s,size:l,asChild:i=!1,...d}=e,p=i?o.DX:"button";return(0,a.jsx)(p,{className:(0,n.cn)(c({variant:s,size:l,className:r})),ref:t,...d})});d.displayName="Button";let p=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});p.displayName="Card";let m=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});m.displayName="CardHeader";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});u.displayName="CardTitle",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})}).displayName="CardDescription";let h=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});h.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter";let x=(0,i.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function g(e){let{className:t,variant:r,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)(x({variant:r}),t),...s})}var f=r(8822),b=r(2516),w=r(7188),v=r(9076),y=r(4666),j=r(4331),N=r(2851),S=r(1153),k=r(2184),C=r(5024),A=r(3210);let E=s.forwardRef((e,t)=>{let{className:r,type:s,...l}=e;return(0,a.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...l})});E.displayName="Input";var P=r(8555);let M=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),R=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(P.b,{ref:t,className:(0,n.cn)(M(),r),...s})});R.displayName=P.b.displayName;let T=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...s})});T.displayName="Textarea";var L=r(587),F=r(6722);let U=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(L.bL,{ref:t,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...s,children:(0,a.jsx)(L.C1,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(F.A,{className:"h-4 w-4"})})})});U.displayName=L.bL.displayName;var D=r(5844),O=r(2522),I=r(6546),z=r(7326),G=r(3585),_=r(7156),V=r(2225),Z=r(4548),q=r(7500),B=r(6524);function H(e){let{pin:t,onSubmit:r,onCancel:l}=e,[o,i]=(0,s.useState)(""),[n,c]=(0,s.useState)(""),[x,f]=(0,s.useState)(""),[b,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)(""),[S,k]=(0,s.useState)(""),[C,A]=(0,s.useState)(""),[P,M]=(0,s.useState)(""),[L,F]=(0,s.useState)(!1),[H,Y]=(0,s.useState)(!1),[W,J]=(0,s.useState)({}),K=()=>{let e={};return o.trim()||(e.firstName="First name is required"),n&&!/^\+?[\d\s\-()]{10,}$/.test(n.replace(/\s/g,""))&&(e.phone="Please enter a valid phone number"),x&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(x)&&(e.email="Please enter a valid email address"),J(e),0===Object.keys(e).length},X=async()=>{x&&(Y(!0),(0,D.oR)({title:"Promo Material Sent!",description:"PulseChain educational materials have been sent to ".concat(x)}),setTimeout(()=>Y(!1),3e3))},$=async e=>{if(e.preventDefault(),K()){F(!0);try{let e={firstName:o.trim(),phone:n.trim()||void 0,email:x.trim()||void 0,ownsCrypto:b,socials:{twitter:j.trim()||void 0,telegram:S.trim()||void 0,reddit:C.trim()||void 0},notes:P.trim()||void 0,pinId:t.id,address:t.address,timestamp:new Date};await new Promise(e=>setTimeout(e,1e3)),r(e)}catch(e){console.error("Error submitting onboard form:",e),(0,D.oR)({title:"Error",description:"Failed to submit form. Please try again.",variant:"destructive"})}finally{F(!1)}}},Q=e=>{let t=e.replace(/\D/g,"");return t.length>=6?"(".concat(t.slice(0,3),") ").concat(t.slice(3,6),"-").concat(t.slice(6,10)):t.length>=3?"(".concat(t.slice(0,3),") ").concat(t.slice(3)):t},ee=(e,t)=>{let r=e.replace(/^@/,"");return"twitter"===t?r=r.replace(/^(https?:\/\/)?(www\.)?(twitter\.com\/|x\.com\/)?/,""):"telegram"===t?r=r.replace(/^(https?:\/\/)?(www\.)?(t\.me\/)?/,""):"reddit"===t&&(r=r.replace(/^(https?:\/\/)?(www\.)?(reddit\.com\/u\/)?/,"")),r};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"relative w-full max-w-lg",children:[(0,a.jsx)(GlowingEffect,{spread:40,glow:!0,disabled:!1,proximity:64,inactiveZone:.01}),(0,a.jsxs)(p,{className:"bg-white/95 backdrop-blur-sm max-h-[90vh] overflow-y-auto border-purple-200 shadow-xl",children:[(0,a.jsx)(m,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(u,{className:"flex items-center gap-2 text-purple-700 text-lg",children:[(0,a.jsx)(v.A,{className:"h-5 w-5 text-green-600"}),"New Customer Onboarding"]}),(0,a.jsx)(d,{variant:"ghost",size:"sm",onClick:l,className:"text-purple-700 hover:bg-purple-50",children:(0,a.jsx)(O.A,{className:"h-4 w-4"})})]})}),(0,a.jsxs)(h,{children:[(0,a.jsxs)("form",{onSubmit:$,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 p-3 rounded-lg border border-purple-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-purple-600 mb-1",children:[(0,a.jsx)(y.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Location"})]}),t.propertyName&&(0,a.jsx)("p",{className:"font-medium text-sm break-words",children:t.propertyName}),(0,a.jsx)("p",{className:"text-sm text-gray-700 break-words",children:t.address}),(0,a.jsx)(g,{variant:"outline",className:"mt-2 border-purple-200 text-purple-700",children:"New Customer"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(R,{htmlFor:"firstName",className:"flex items-center gap-2 text-purple-700",children:[(0,a.jsx)(I.A,{className:"h-4 w-4"}),"First Name *"]}),(0,a.jsx)(E,{id:"firstName",type:"text",value:o,onChange:e=>i(e.target.value),placeholder:"Enter customer's first name",className:"border-purple-200 focus:border-purple-400 ".concat(W.firstName?"border-red-500":""),required:!0}),W.firstName&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:W.firstName})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(R,{htmlFor:"phone",className:"flex items-center gap-2 text-purple-700",children:[(0,a.jsx)(z.A,{className:"h-4 w-4"}),"Phone Number (Optional)"]}),(0,a.jsx)(E,{id:"phone",type:"tel",value:n,onChange:e=>{c(Q(e.target.value))},placeholder:"(555) 123-4567",className:"border-purple-200 focus:border-purple-400 ".concat(W.phone?"border-red-500":""),maxLength:14}),W.phone&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:W.phone})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(R,{htmlFor:"email",className:"flex items-center gap-2 text-purple-700",children:[(0,a.jsx)(G.A,{className:"h-4 w-4"}),"Email Address (Optional)"]}),(0,a.jsx)(E,{id:"email",type:"email",value:x,onChange:e=>f(e.target.value),placeholder:"customer@example.com",className:"border-purple-200 focus:border-purple-400 ".concat(W.email?"border-red-500":"")}),W.email&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:W.email})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(U,{id:"ownsCrypto",checked:b,onCheckedChange:e=>w(e),className:"border-purple-300 data-[state=checked]:bg-purple-600"}),(0,a.jsxs)(R,{htmlFor:"ownsCrypto",className:"flex items-center gap-2 text-sm text-purple-700",children:[(0,a.jsx)(_.A,{className:"h-4 w-4"}),"Owns Cryptocurrency (Optional)"]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(R,{className:"text-sm font-medium text-purple-700",children:"Social Media (Optional)"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)(R,{htmlFor:"twitter",className:"flex items-center gap-2 text-sm text-purple-600",children:[(0,a.jsx)(V.A,{className:"h-4 w-4"}),"Twitter/X Handle"]}),(0,a.jsx)(E,{id:"twitter",type:"text",value:j,onChange:e=>N(ee(e.target.value,"twitter")),placeholder:"username",className:"border-purple-200 focus:border-purple-400"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)(R,{htmlFor:"telegram",className:"flex items-center gap-2 text-sm text-purple-600",children:[(0,a.jsx)(Z.A,{className:"h-4 w-4"}),"Telegram Handle"]}),(0,a.jsx)(E,{id:"telegram",type:"text",value:S,onChange:e=>k(ee(e.target.value,"telegram")),placeholder:"username",className:"border-purple-200 focus:border-purple-400"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)(R,{htmlFor:"reddit",className:"flex items-center gap-2 text-sm text-purple-600",children:[(0,a.jsx)(Z.A,{className:"h-4 w-4"}),"Reddit Username"]}),(0,a.jsx)(E,{id:"reddit",type:"text",value:C,onChange:e=>A(ee(e.target.value,"reddit")),placeholder:"username",className:"border-purple-200 focus:border-purple-400"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(d,{type:"button",variant:"outline",className:"w-full bg-transparent border-purple-200 text-purple-700 hover:bg-purple-50 text-sm",onClick:X,disabled:!x||H,children:[(0,a.jsx)(q.A,{className:"h-4 w-4 mr-2"}),H?"PulseChain Materials Sent!":"Send PulseChain Materials"]}),!x&&(0,a.jsx)("p",{className:"text-xs text-purple-600",children:"Email address required to send educational materials"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(R,{htmlFor:"notes",className:"flex items-center gap-2 text-purple-700",children:[(0,a.jsx)(B.A,{className:"h-4 w-4"}),"Add Note (Optional)"]}),(0,a.jsx)(T,{id:"notes",value:P,onChange:e=>M(e.target.value),placeholder:"Add any notes about this customer or interaction...",rows:3,className:"resize-none border-purple-200 focus:border-purple-400"})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)(d,{type:"button",variant:"outline",onClick:l,className:"flex-1 bg-transparent border-purple-200 text-purple-700 hover:bg-purple-50 text-sm",children:"Cancel"}),(0,a.jsx)(d,{type:"submit",disabled:L,className:"flex-1 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-sm",children:L?"Processing...":"Onboard Now!"})]})]}),(0,a.jsx)("div",{className:"mt-4 p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border border-purple-200",children:(0,a.jsxs)("p",{className:"text-xs text-purple-800",children:[(0,a.jsx)("strong",{children:"Note:"})," Only first name is required. All other fields are optional but help with PulseChain education follow-up and engagement."]})})]})]})]})})}var Y=r(5516),W=r(6539),J=r(2477);function K(e){let{pin:t,onSave:r,onCancel:l}=e,[o,i]=(0,s.useState)(""),[n,c]=(0,s.useState)(""),[x,f]=(0,s.useState)(""),[b,v]=(0,s.useState)(!1),[j,N]=(0,s.useState)({}),S=new Date().toISOString().split("T")[0],k=()=>{let e={};return o||(e.date="Date is required"),n||(e.time="Time is required"),o&&new Date(o)<new Date(S)&&(e.date="Date cannot be in the past"),N(e),0===Object.keys(e).length},C=async e=>{if(e.preventDefault(),k()){v(!0);try{let e={id:Date.now().toString(),pinId:t.id,address:t.address,propertyName:t.propertyName,date:o,time:n,notes:x.trim()||void 0,timestamp:new Date};await new Promise(e=>setTimeout(e,800)),r(e),(0,D.oR)({title:"Follow-up Scheduled!",description:"Appointment scheduled for ".concat(new Date(o).toLocaleDateString()," at ").concat(n)})}catch(e){console.error("Error saving follow-up:",e),(0,D.oR)({title:"Error",description:"Failed to schedule follow-up. Please try again.",variant:"destructive"})}finally{v(!1)}}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,a.jsx)(J.Z,{spread:40,glow:!0,disabled:!1,proximity:64,inactiveZone:.01}),(0,a.jsxs)(p,{className:"bg-white/95 backdrop-blur-sm border-purple-200 shadow-xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(m,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(u,{className:"flex items-center gap-2 text-purple-700 text-lg",children:[(0,a.jsx)(Y.A,{className:"h-5 w-5 text-blue-600"}),"Schedule Follow-up"]}),(0,a.jsx)(d,{variant:"ghost",size:"sm",onClick:l,className:"text-purple-700 hover:bg-purple-50",children:(0,a.jsx)(O.A,{className:"h-4 w-4"})})]})}),(0,a.jsxs)(h,{children:[(0,a.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 p-3 rounded-lg border border-purple-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-purple-600 mb-1",children:[(0,a.jsx)(y.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Location"})]}),t.propertyName&&(0,a.jsx)("p",{className:"font-medium text-sm break-words",children:t.propertyName}),(0,a.jsx)("p",{className:"text-sm text-gray-700 break-words",children:t.address}),(0,a.jsx)(g,{variant:"outline",className:"mt-2 border-blue-200 text-blue-700",children:"Follow-up Required"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(R,{htmlFor:"date",className:"flex items-center gap-2 text-purple-700",children:[(0,a.jsx)(Y.A,{className:"h-4 w-4"}),"Date *"]}),(0,a.jsx)(E,{id:"date",type:"date",value:o,onChange:e=>i(e.target.value),min:S,className:"border-purple-200 focus:border-purple-400 ".concat(j.date?"border-red-500":""),required:!0}),j.date&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:j.date})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(R,{htmlFor:"time",className:"flex items-center gap-2 text-purple-700",children:[(0,a.jsx)(w.A,{className:"h-4 w-4"}),"Time *"]}),(0,a.jsx)(E,{id:"time",type:"time",value:n,onChange:e=>c(e.target.value),className:"border-purple-200 focus:border-purple-400 ".concat(j.time?"border-red-500":""),required:!0}),j.time&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:j.time})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(R,{htmlFor:"notes",className:"flex items-center gap-2 text-purple-700",children:[(0,a.jsx)(w.A,{className:"h-4 w-4"}),"Notes (Optional)"]}),(0,a.jsx)(T,{id:"notes",value:x,onChange:e=>f(e.target.value),placeholder:"Add any notes about this follow-up appointment...",rows:3,className:"resize-none border-purple-200 focus:border-purple-400"})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)(d,{type:"button",variant:"outline",onClick:l,className:"flex-1 bg-transparent border-purple-200 text-purple-700 hover:bg-purple-50 text-sm",children:"Cancel"}),(0,a.jsxs)(d,{type:"submit",disabled:b,className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-sm",children:[(0,a.jsx)(W.A,{className:"h-4 w-4 mr-2"}),b?"Scheduling...":"Schedule Follow-up"]})]})]}),(0,a.jsx)("div",{className:"mt-4 p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border border-purple-200",children:(0,a.jsxs)("p",{className:"text-xs text-purple-800",children:[(0,a.jsx)("strong",{children:"Tip:"})," Choose a convenient time for both you and the customer. You can add notes to remember specific details about this follow-up."]})})]})]})]})})}var X=r(1251),$=r(2297),Q=r(3602);function ee(e){let{followUps:t,onClose:r}=e,[l,o]=(0,s.useState)(new Date),[i,n]=(0,s.useState)(null),c=e=>t.filter(t=>t.date===e),x=(e,t,r)=>"".concat(e,"-").concat(String(t+1).padStart(2,"0"),"-").concat(String(r).padStart(2,"0")),f=e=>!!e&&c(x(l.getFullYear(),l.getMonth(),e)).length>0,b=e=>{if(!e)return;let t=x(l.getFullYear(),l.getMonth(),e);c(t).length>0&&n(t)},v=e=>{o(t=>{let r=new Date(t);return"prev"===e?r.setMonth(t.getMonth()-1):r.setMonth(t.getMonth()+1),r})},j=e=>{let[t,r]=e.split(":"),a=Number.parseInt(t);return"".concat(a%12||12,":").concat(r," ").concat(a>=12?"PM":"AM")},N=(e=>{let t=e.getFullYear(),r=e.getMonth(),a=new Date(t,r,1),s=new Date(t,r+1,0).getDate(),l=a.getDay(),o=[];for(let e=0;e<l;e++)o.push(null);for(let e=1;e<=s;e++)o.push(e);return o})(l),S=i?c(i):[];return i?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:e=>{e.target===e.currentTarget&&n(null)},children:(0,a.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,a.jsx)(J.Z,{spread:40,glow:!0,disabled:!1,proximity:64,inactiveZone:.01}),(0,a.jsxs)(p,{className:"bg-white/95 backdrop-blur-sm border-purple-200 shadow-xl max-h-[80vh] overflow-y-auto",children:[(0,a.jsx)(m,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(u,{className:"flex items-center gap-2 text-purple-700 text-base sm:text-lg",children:[(0,a.jsx)(Y.A,{className:"h-5 w-5 text-blue-600"}),(0,a.jsx)("span",{className:"truncate",children:new Date(i).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(d,{variant:"ghost",size:"sm",onClick:()=>n(null),className:"text-purple-700 hover:bg-purple-50",children:(0,a.jsx)(X.A,{className:"h-4 w-4"})}),(0,a.jsx)(d,{variant:"ghost",size:"sm",onClick:r,className:"text-purple-700 hover:bg-purple-50",children:(0,a.jsx)(O.A,{className:"h-4 w-4"})})]})]})}),(0,a.jsx)(h,{className:"space-y-4",children:0===S.length?(0,a.jsx)("p",{className:"text-center text-gray-500 py-8 text-sm",children:"No follow-ups scheduled for this day"}):S.map(e=>(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(J.Z,{spread:20,glow:!0,disabled:!1,proximity:32,inactiveZone:.01}),(0,a.jsx)(p,{className:"border border-blue-200 bg-blue-50/50",children:(0,a.jsxs)(h,{className:"p-3 sm:p-4 space-y-2",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)(g,{variant:"outline",className:"border-blue-300 text-blue-700 text-xs",children:[(0,a.jsx)(w.A,{className:"h-3 w-3 mr-1"}),j(e.time)]})}),(0,a.jsxs)("div",{children:[e.propertyName&&(0,a.jsx)("p",{className:"font-medium text-sm break-words",children:e.propertyName}),(0,a.jsxs)("div",{className:"flex items-start gap-1 text-sm text-gray-600",children:[(0,a.jsx)(y.A,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),(0,a.jsx)("span",{className:"break-words",children:e.address})]})]}),e.notes&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Notes:"}),(0,a.jsx)("p",{className:"text-sm text-gray-800 break-words",children:e.notes})]})]})})]},e.id))})]})]})}):(0,a.jsx)("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:e=>{e.target===e.currentTarget&&r()},children:(0,a.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,a.jsx)(J.Z,{spread:40,glow:!0,disabled:!1,proximity:64,inactiveZone:.01}),(0,a.jsxs)(p,{className:"bg-white/95 backdrop-blur-sm border-purple-200 shadow-xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(m,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(u,{className:"flex items-center gap-2 text-purple-700 text-lg",children:[(0,a.jsx)(Y.A,{className:"h-5 w-5 text-blue-600"}),"Follow-up Calendar"]}),(0,a.jsx)(d,{variant:"ghost",size:"sm",onClick:r,className:"text-purple-700 hover:bg-purple-50",children:(0,a.jsx)(O.A,{className:"h-4 w-4"})})]})}),(0,a.jsxs)(h,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(d,{variant:"outline",size:"sm",onClick:()=>v("prev"),className:"border-purple-200 text-purple-700 hover:bg-purple-50",children:(0,a.jsx)($.A,{className:"h-4 w-4"})}),(0,a.jsxs)("h3",{className:"text-base sm:text-lg font-semibold text-purple-700 truncate",children:[["January","February","March","April","May","June","July","August","September","October","November","December"][l.getMonth()]," ",l.getFullYear()]}),(0,a.jsx)(d,{variant:"outline",size:"sm",onClick:()=>v("next"),className:"border-purple-200 text-purple-700 hover:bg-purple-50",children:(0,a.jsx)(Q.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-7 gap-1",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,a.jsx)("div",{className:"text-center text-xs font-medium text-gray-500 p-1 sm:p-2",children:e},e)),N.map((e,t)=>(0,a.jsx)("div",{className:"\n                  relative text-center p-1 sm:p-2 text-sm cursor-pointer rounded-md transition-colors min-h-[32px] sm:min-h-[36px] flex items-center justify-center\n                  ".concat(e?"hover:bg-purple-50":"","\n                  ").concat(e&&f(e)?"bg-blue-50 border border-blue-200":"","\n                "),onClick:()=>e&&b(e),children:e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:f(e)?"text-blue-700 font-medium":"text-gray-700",children:e}),f(e)&&(0,a.jsx)("div",{className:"absolute bottom-0.5 left-1/2 transform -translate-x-1/2",children:(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"})})]})},t))]}),(0,a.jsx)("div",{className:"flex items-center justify-center gap-4 text-xs text-gray-600 pt-2 border-t border-purple-100",children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,a.jsx)("span",{children:"Has Follow-ups"})]})}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-3 rounded-lg border border-purple-200",children:(0,a.jsxs)("p",{className:"text-xs text-purple-800 text-center",children:[(0,a.jsx)("strong",{children:t.length})," total follow-ups scheduled"]})})]})]})]})})}var et=r(5058);function er(){let[e,t]=(0,s.useState)(!0),[r,a]=(0,s.useState)(!1),[l,o]=(0,s.useState)(!1),[i,n]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=()=>t(!0),r=()=>t(!1),s=e=>{e.preventDefault(),n(e),a(!0)},l=()=>{o(!0),a(!1),n(null)};return t(navigator.onLine),(()=>{let e=window.matchMedia("(display-mode: standalone)").matches,t=!0===window.navigator.standalone;o(e||t)})(),window.addEventListener("online",e),window.addEventListener("offline",r),window.addEventListener("beforeinstallprompt",s),window.addEventListener("appinstalled",l),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",r),window.removeEventListener("beforeinstallprompt",s),window.removeEventListener("appinstalled",l)}},[]),{isOnline:e,isInstallable:r,isInstalled:l,installApp:async()=>{if(!i)return!1;try{await i.prompt();let{outcome:e}=await i.userChoice;if("accepted"===e)return a(!1),n(null),!0;return!1}catch(e){return console.error("Error installing app:",e),!1}}}}function ea(){let{isInstallable:e,isInstalled:t,installApp:r}=er(),[l,o]=(0,s.useState)(!1),[i,n]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let r=setTimeout(()=>{!e||t||i||o(!0)},3e4);return()=>clearTimeout(r)},[e,t,i]),(0,s.useEffect)(()=>{localStorage.getItem("pwa-install-dismissed")&&n(!0)},[]);let c=async()=>{await r()&&o(!1)};return l&&e&&!t?(0,a.jsx)("div",{className:"fixed bottom-4 left-4 right-4 z-50 md:left-auto md:right-4 md:max-w-sm",children:(0,a.jsx)(p,{className:"bg-white/95 backdrop-blur-sm border-purple-200 shadow-xl",children:(0,a.jsx)(h,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 p-2 rounded-lg",children:(0,a.jsx)("img",{src:"/pulsechain-logo.png",alt:"PulseChain",className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-1",children:"Install PulseChain Tracker"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Add to your home screen for quick access and offline use!"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(d,{size:"sm",onClick:c,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[(0,a.jsx)(et.A,{className:"h-4 w-4 mr-1"}),"Install"]}),(0,a.jsxs)(d,{variant:"outline",size:"sm",onClick:()=>{o(!1),n(!0),localStorage.setItem("pwa-install-dismissed","true")},children:[(0,a.jsx)(O.A,{className:"h-4 w-4 mr-1"}),"Not Now"]})]})]})]})})})}):null}var es=r(3345);let el=(0,es.createServerReference)("00e2b3fd2ba70015d4c2b345d70998b495bb724728",es.callServer,void 0,es.findSourceMapURL,"getGoogleMapsConfig"),eo=(0,es.createServerReference)("70e9653fbc4c26e24741071a3c2a4e3dd472600158",es.callServer,void 0,es.findSourceMapURL,"generateStreetViewUrl");class ei{async init(){return new Promise((e,t)=>{let r=indexedDB.open(this.dbName,this.version);r.onerror=()=>t(r.error),r.onsuccess=()=>{this.db=r.result,e()},r.onupgradeneeded=e=>{let t=e.target.result;if(!t.objectStoreNames.contains("pins")){let e=t.createObjectStore("pins",{keyPath:"id"});e.createIndex("status","status",{unique:!1}),e.createIndex("timestamp","timestamp",{unique:!1})}if(!t.objectStoreNames.contains("followUps")){let e=t.createObjectStore("followUps",{keyPath:"id"});e.createIndex("date","date",{unique:!1}),e.createIndex("pinId","pinId",{unique:!1})}if(!t.objectStoreNames.contains("customers")){let e=t.createObjectStore("customers",{keyPath:"pinId"});e.createIndex("firstName","firstName",{unique:!1}),e.createIndex("timestamp","timestamp",{unique:!1})}t.objectStoreNames.contains("sync")||t.createObjectStore("sync",{keyPath:"type"})}})}async savePin(e){this.db||await this.init();let t=this.db.transaction(["pins"],"readwrite").objectStore("pins");await t.put({...e,offline:!0})}async savePins(e){this.db||await this.init();let t=this.db.transaction(["pins"],"readwrite").objectStore("pins");for(let r of e)await t.put(r)}async getPins(){return this.db||await this.init(),new Promise((e,t)=>{let r=this.db.transaction(["pins"],"readonly").objectStore("pins").getAll();r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})}async saveFollowUp(e){this.db||await this.init();let t=this.db.transaction(["followUps"],"readwrite").objectStore("followUps");await t.put({...e,offline:!0})}async getFollowUps(){return this.db||await this.init(),new Promise((e,t)=>{let r=this.db.transaction(["followUps"],"readonly").objectStore("followUps").getAll();r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})}async saveCustomer(e){this.db||await this.init();let t=this.db.transaction(["customers"],"readwrite").objectStore("customers");await t.put({...e,offline:!0})}async getCustomers(){return this.db||await this.init(),new Promise((e,t)=>{let r=this.db.transaction(["customers"],"readonly").objectStore("customers").getAll();r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})}async getOfflineData(){this.db||await this.init();let[e,t,r]=await Promise.all([this.getPins(),this.getFollowUps(),this.getCustomers()]);return{pins:e.filter(e=>e.offline),followUps:t.filter(e=>e.offline),customers:r.filter(e=>e.offline)}}async markAsSynced(e,t){this.db||await this.init();let r=this.db.transaction([e],"readwrite").objectStore(e);for(let e of t){let t=r.get(e);t.onsuccess=()=>{let e=t.result;e&&(delete e.offline,r.put(e))}}}async clearAll(){this.db||await this.init();let e=this.db.transaction(["pins","followUps","customers","sync"],"readwrite");await Promise.all([e.objectStore("pins").clear(),e.objectStore("followUps").clear(),e.objectStore("customers").clear(),e.objectStore("sync").clear()])}constructor(){this.dbName="pulsechain-tracker",this.version=1,this.db=null}}let en=new ei;var ec=r(7273),ed=r(7531),ep=r(9187),em=r(5714),eu=r(2235);let eh=["#ef4444","#3b82f6","#22c55e","#f59e0b","#8b5cf6","#ec4899","#06b6d4","#84cc16","#f97316","#6366f1"];function ex(e){let{territories:t,onClose:r,onUpdateTerritory:l,onDeleteTerritory:o,onToggleTerritoryVisibility:i,visibleTerritories:n}=e,[c,x]=(0,s.useState)(null),[f,b]=(0,s.useState)(""),[w,v]=(0,s.useState)(""),j=e=>{x(e.id),b(e.name),v(e.color)},N=()=>{if(!c||!f.trim())return;let e=t.find(e=>e.id===c);if(!e)return;let r={...e,name:f.trim(),color:w,updatedAt:new Date};l(r),x(null),b(""),v(""),(0,D.oR)({title:"Territory Updated",description:'"'.concat(r.name,'" has been updated successfully.')})},S=()=>{x(null),b(""),v("")},k=e=>{confirm('Are you sure you want to delete "'.concat(e.name,'"? This action cannot be undone.'))&&(o(e.id),(0,D.oR)({title:"Territory Deleted",description:'"'.concat(e.name,'" has been deleted.'),variant:"destructive"}))},C=e=>{if(e.length<3)return"0";let t=e.reduce((e,t)=>({minLat:Math.min(e.minLat,t.lat),maxLat:Math.max(e.maxLat,t.lat),minLng:Math.min(e.minLng,t.lng),maxLng:Math.max(e.maxLng,t.lng)}),{minLat:e[0].lat,maxLat:e[0].lat,minLng:e[0].lng,maxLng:e[0].lng});return(1e4*Math.abs((t.maxLat-t.minLat)*(t.maxLng-t.minLng))).toFixed(2)};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:e=>{e.target===e.currentTarget&&r()},children:(0,a.jsxs)("div",{className:"relative w-full max-w-2xl",children:[(0,a.jsx)(J.Z,{spread:40,glow:!0,disabled:!1,proximity:64,inactiveZone:.01}),(0,a.jsxs)(p,{className:"bg-white/95 backdrop-blur-sm border-purple-200 shadow-xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(m,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(u,{className:"flex items-center gap-2 text-purple-700 text-lg",children:[(0,a.jsx)(ec.A,{className:"h-5 w-5 text-blue-600"}),"Territory Manager"]}),(0,a.jsx)(d,{variant:"ghost",size:"sm",onClick:r,className:"text-purple-700 hover:bg-purple-50",children:(0,a.jsx)(O.A,{className:"h-4 w-4"})})]})}),(0,a.jsxs)(h,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 p-3 rounded-lg border border-purple-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-purple-600 mb-1",children:[(0,a.jsx)(y.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Territory Overview"})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,a.jsx)("strong",{children:t.length})," territories created"]}),(0,a.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"Click the eye icon to show/hide territories on the map"})]}),0===t.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(ec.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-gray-500 mb-2",children:"No territories created yet"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Click the drawing tools on the map to create your first territory"})]}):(0,a.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(J.Z,{spread:20,glow:!0,disabled:!1,proximity:32,inactiveZone:.01}),(0,a.jsx)(p,{className:"border border-gray-200",children:(0,a.jsx)(h,{className:"p-4",children:c===e.id?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(R,{htmlFor:"edit-name",className:"text-sm font-medium text-purple-700",children:"Territory Name"}),(0,a.jsx)(E,{id:"edit-name",value:f,onChange:e=>b(e.target.value),placeholder:"Enter territory name",className:"border-purple-200 focus:border-purple-400"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(R,{className:"text-sm font-medium text-purple-700",children:"Territory Color"}),(0,a.jsx)("div",{className:"flex gap-2 flex-wrap",children:eh.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>v(e),className:"w-8 h-8 rounded-full border-2 transition-all ".concat(w===e?"border-purple-500 scale-110":"border-gray-300 hover:border-purple-300"),style:{backgroundColor:e},title:e},e))})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(d,{size:"sm",onClick:N,disabled:!f.trim(),className:"bg-green-600 hover:bg-green-700 text-white",children:[(0,a.jsx)(W.A,{className:"h-3 w-3 mr-1"}),"Save"]}),(0,a.jsx)(d,{size:"sm",variant:"outline",onClick:S,className:"border-gray-300 text-gray-700 hover:bg-gray-50 bg-transparent",children:"Cancel"})]})]}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full border border-white shadow-sm",style:{backgroundColor:e.color}}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 break-words",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Created ",e.createdAt.toLocaleDateString(),e.updatedAt&&e.updatedAt!==e.createdAt&&(0,a.jsxs)("span",{children:[" â€¢ Updated ",e.updatedAt.toLocaleDateString()]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(d,{size:"sm",variant:"ghost",onClick:()=>i(e.id),className:"text-gray-600 hover:bg-gray-100",title:n.has(e.id)?"Hide territory":"Show territory",children:n.has(e.id)?(0,a.jsx)(ed.A,{className:"h-4 w-4"}):(0,a.jsx)(ep.A,{className:"h-4 w-4"})}),(0,a.jsx)(d,{size:"sm",variant:"ghost",onClick:()=>j(e),className:"text-blue-600 hover:bg-blue-50",children:(0,a.jsx)(em.A,{className:"h-4 w-4"})}),(0,a.jsx)(d,{size:"sm",variant:"ghost",onClick:()=>k(e),className:"text-red-600 hover:bg-red-50",children:(0,a.jsx)(eu.A,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Points:"}),(0,a.jsx)("p",{className:"font-mono text-xs",children:e.coordinates.length})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Area (approx):"}),(0,a.jsxs)("p",{className:"font-mono text-xs",children:[C(e.coordinates)," units"]})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:(0,a.jsx)(g,{variant:"outline",className:"text-xs ".concat(n.has(e.id)?"border-green-300 text-green-700":"border-gray-300 text-gray-600"),children:n.has(e.id)?"Visible":"Hidden"})})]})})})]},e.id))}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-3 rounded-lg border border-purple-200",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2 text-sm text-purple-700",children:"How to create territories:"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-xs text-purple-800",children:[(0,a.jsx)("li",{children:"Click the polygon tool in the drawing controls"}),(0,a.jsx)("li",{children:"Click on the map to create polygon points"}),(0,a.jsx)("li",{children:"Double-click to complete the territory"}),(0,a.jsx)("li",{children:"Give your territory a name and choose a color"}),(0,a.jsx)("li",{children:"Use this manager to edit, hide, or delete territories"})]})]})]})]})]})})}var eg=r(6617);let ef=["#ef4444","#3b82f6","#22c55e","#f59e0b","#8b5cf6","#ec4899","#06b6d4","#84cc16","#f97316","#6366f1"];function eb(e){let{coordinates:t,onSave:r,onCancel:l}=e,[o,i]=(0,s.useState)(""),[n,c]=(0,s.useState)(ef[0]),[x,g]=(0,s.useState)({}),f=()=>{let e={};return o.trim()||(e.name="Territory name is required"),g(e),0===Object.keys(e).length};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,a.jsx)(J.Z,{spread:40,glow:!0,disabled:!1,proximity:64,inactiveZone:.01}),(0,a.jsxs)(p,{className:"bg-white/95 backdrop-blur-sm border-purple-200 shadow-xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(m,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(u,{className:"flex items-center gap-2 text-purple-700 text-lg",children:[(0,a.jsx)(ec.A,{className:"h-5 w-5 text-blue-600"}),"Create Territory"]}),(0,a.jsx)(d,{variant:"ghost",size:"sm",onClick:l,className:"text-purple-700 hover:bg-purple-50",children:(0,a.jsx)(O.A,{className:"h-4 w-4"})})]})}),(0,a.jsxs)(h,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 p-3 rounded-lg border border-purple-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-purple-600 mb-1",children:[(0,a.jsx)(ec.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Territory Details"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Points:"}),(0,a.jsx)("p",{className:"font-mono text-xs",children:t.length})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Area (approx):"}),(0,a.jsxs)("p",{className:"font-mono text-xs",children:[(()=>{if(t.length<3)return"0";let e=t.reduce((e,t)=>({minLat:Math.min(e.minLat,t.lat),maxLat:Math.max(e.maxLat,t.lat),minLng:Math.min(e.minLng,t.lng),maxLng:Math.max(e.maxLng,t.lng)}),{minLat:t[0].lat,maxLat:t[0].lat,minLng:t[0].lng,maxLng:t[0].lng});return(1e4*Math.abs((e.maxLat-e.minLat)*(e.maxLng-e.minLng))).toFixed(2)})()," units"]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(R,{htmlFor:"territory-name",className:"flex items-center gap-2 text-purple-700",children:[(0,a.jsx)(ec.A,{className:"h-4 w-4"}),"Territory Name *"]}),(0,a.jsx)(E,{id:"territory-name",type:"text",value:o,onChange:e=>i(e.target.value),placeholder:"Enter a name for this territory",className:"border-purple-200 focus:border-purple-400 ".concat(x.name?"border-red-500":""),required:!0}),x.name&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:x.name})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(R,{className:"flex items-center gap-2 text-purple-700",children:[(0,a.jsx)(eg.A,{className:"h-4 w-4"}),"Territory Color"]}),(0,a.jsx)("div",{className:"grid grid-cols-5 gap-3",children:ef.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>c(e),className:"w-12 h-12 rounded-lg border-2 transition-all hover:scale-105 ".concat(n===e?"border-purple-500 ring-2 ring-purple-300 scale-105":"border-gray-300 hover:border-purple-300"),style:{backgroundColor:e},title:e},e))}),(0,a.jsxs)("p",{className:"text-xs text-gray-600",children:["Selected color: ",n]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg border",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2 text-sm",children:"Preview:"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded border-2 border-white shadow-sm",style:{backgroundColor:n}}),(0,a.jsx)("span",{className:"text-sm font-medium",children:o||"Unnamed Territory"})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)(d,{type:"button",variant:"outline",onClick:l,className:"flex-1 bg-transparent border-purple-200 text-purple-700 hover:bg-purple-50 text-sm",children:"Cancel"}),(0,a.jsxs)(d,{type:"button",onClick:()=>{f()&&r(o.trim(),n)},disabled:!o.trim(),className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-sm",children:[(0,a.jsx)(W.A,{className:"h-4 w-4 mr-2"}),"Create Territory"]})]}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-3 rounded-lg border border-purple-200",children:(0,a.jsxs)("p",{className:"text-xs text-purple-800",children:[(0,a.jsx)("strong",{children:"Tip:"})," Choose a descriptive name and distinct color for easy identification. You can edit or delete this territory later using the Territory Manager."]})})]})]})]})})}let ew=(0,es.createServerReference)("40490c01570a492dfca4ae3b1fa5d86ed66ac7d1cf",es.callServer,void 0,es.findSourceMapURL,"saveTerritory"),ev=(0,es.createServerReference)("00e545f6d514b9ccb19d9858bd8667bf9ca9117458",es.callServer,void 0,es.findSourceMapURL,"getAllTerritories"),ey=(0,es.createServerReference)("40be4571c72b72887bba9d6fcf300b23e2327e05c4",es.callServer,void 0,es.findSourceMapURL,"getTerritory"),ej=(0,es.createServerReference)("4039fc041f2064dc89617f96e7c30ac11af57525f0",es.callServer,void 0,es.findSourceMapURL,"updateTerritory"),eN=(0,es.createServerReference)("40e00994b19f3f790f637c0c2072370762932feb6b",es.callServer,void 0,es.findSourceMapURL,"deleteTerritory");class eS{async init(){return Promise.resolve()}async saveTerritory(e){try{await ew(e)}catch(e){throw console.error("Error saving territory:",e),e}}async getTerritories(){try{return await ev()}catch(e){throw console.error("Error loading territories:",e),e}}async getTerritory(e){try{return await ey(e)}catch(e){throw console.error("Error loading territory:",e),e}}async updateTerritory(e){try{await ej(e)}catch(e){throw console.error("Error updating territory:",e),e}}async deleteTerritory(e){try{await eN(e)}catch(e){throw console.error("Error deleting territory:",e),e}}async clearTerritories(){try{let e=await this.getTerritories();await Promise.all(e.map(e=>this.deleteTerritory(e.id)))}catch(e){throw console.error("Error clearing territories:",e),e}}}let ek=new eS,eC=(0,es.createServerReference)("402f5c7634e945269b23ddcd80034b75f5ad0bc6a6",es.callServer,void 0,es.findSourceMapURL,"saveFollowUpData"),eA=(0,es.createServerReference)("005878bd7b9ec5d068ff7492ff20cd2b41dce8f051",es.callServer,void 0,es.findSourceMapURL,"getAllFollowUps"),eE=(0,es.createServerReference)("402bd90681f9fef537914d5515a2fad93583bde6c9",es.callServer,void 0,es.findSourceMapURL,"getFollowUp"),eP=(0,es.createServerReference)("4046a5d9c084c147454b384f3ad38c9fb0c048727b",es.callServer,void 0,es.findSourceMapURL,"getFollowUpsByPin"),eM=(0,es.createServerReference)("60b2c68a71dcec78398ebf2868fcbba94bd3d8061a",es.callServer,void 0,es.findSourceMapURL,"getFollowUpsByDateRange"),eR=(0,es.createServerReference)("405ddf3ec88f65735f73c1ee2e3c8fc88d7ecfba1e",es.callServer,void 0,es.findSourceMapURL,"updateFollowUp"),eT=(0,es.createServerReference)("40ae230592c0bea19cc94f85ed964cfd13484572fa",es.callServer,void 0,es.findSourceMapURL,"deleteFollowUp"),eL=(0,es.createServerReference)("403355c2bca24eec20cae393083927b45bfee7e10e",es.callServer,void 0,es.findSourceMapURL,"createFollowUp");class eF{async init(){return Promise.resolve()}async saveFollowUp(e){try{return await eC(e)}catch(e){throw console.error("Error saving follow-up:",e),e}}async getFollowUps(){try{return await eA()}catch(e){throw console.error("Error loading follow-ups:",e),e}}async getFollowUp(e){try{return await eE(e)}catch(e){throw console.error("Error loading follow-up:",e),e}}async getAllFollowUps(){try{return await eA()}catch(e){throw console.error("Error loading all follow-ups:",e),e}}async getFollowUpsByPin(e){try{return await eP(e)}catch(e){throw console.error("Error loading follow-ups for pin:",e),e}}async getFollowUpsByDateRange(e,t){try{return await eM(e,t)}catch(e){throw console.error("Error loading follow-ups by date range:",e),e}}async updateFollowUp(e){try{return await eR(e)}catch(e){throw console.error("Error updating follow-up:",e),e}}async deleteFollowUp(e){try{await eT(e)}catch(e){throw console.error("Error deleting follow-up:",e),e}}async clearFollowUps(){try{let e=await this.getFollowUps();await Promise.all(e.map(e=>this.deleteFollowUp(e.id)))}catch(e){throw console.error("Error clearing follow-ups:",e),e}}async createFollowUp(e){try{return await eL(e)}catch(e){throw console.error("Error creating follow-up:",e),e}}}let eU=new eF;var eD=r(3928),eO=r(9148),eI=r(8166),ez=r(9323),eG=r(350),e_=r(81),eV=r(6831);class eZ{async createPin(e){try{return await eD.c(e)}catch(e){throw console.error("Error creating pin:",e),e}}async getAllPins(){try{return await eO.I()}catch(e){throw console.error("Error loading pins:",e),e}}async getPin(e){try{return await eI.i(e)}catch(e){throw console.error("Error loading pin:",e),e}}async updatePin(e){try{return await ez.H(e)}catch(e){throw console.error("Error updating pin:",e),e}}async deletePin(e){try{await eG.t(e)}catch(e){throw console.error("Error deleting pin:",e),e}}async savePin(e){try{await e_.x(e)}catch(e){throw console.error("Error saving pin:",e),e}}async updatePinStatus(e,t){try{return await eV.t(e,t)}catch(e){throw console.error("Error updating pin status:",e),e}}}let eq=new eZ;var eB=r(7186);function eH(e){let{setShowCalendarView:t,setShowTerritoryManager:r,setIsModalTransitioning:a}=e,o=(0,l.useSearchParams)();return(0,s.useEffect)(()=>{let e=o.get("view");"calendar"===e?(a(!0),setTimeout(()=>{t(!0),r(!1),a(!1)},100)):"territories"===e?(a(!0),setTimeout(()=>{r(!0),t(!1),a(!1)},100)):(t(!1),r(!1))},[o,t,r,a]),null}function eY(e){let{showCalendarView:t,setShowCalendarView:r,showTerritoryManager:o,setShowTerritoryManager:i,isModalTransitioning:n,setIsModalTransitioning:c}=e,x=(0,l.useRouter)(),E=(0,s.useRef)(null),[P,M]=(0,s.useState)(null),[R,T]=(0,s.useState)([]),[L,F]=(0,s.useState)([]),[U,O]=(0,s.useState)(null),[I,z]=(0,s.useState)(""),[G,_]=(0,s.useState)(!1),[V,Z]=(0,s.useState)(!1),[q,B]=(0,s.useState)(new Set),[Y,W]=(0,s.useState)(""),[X,$]=(0,s.useState)(""),[Q,et]=(0,s.useState)(null),[es,ei]=(0,s.useState)(!1),[ec,ed]=(0,s.useState)(!1),[ep,em]=(0,s.useState)(!1),[eu,eh]=(0,s.useState)(null),[eg,ef]=(0,s.useState)([]),[ew,ev]=(0,s.useState)([]),[ey,ej]=(0,s.useState)(!1),[eN,eS]=(0,s.useState)([]),[eC,eA]=(0,s.useState)([]),[eE,eP]=(0,s.useState)(new Set),[eM,eR]=(0,s.useState)(!1),[eT,eL]=(0,s.useState)([]),[eF,eD]=(0,s.useState)(null),[eO,eI]=(0,s.useState)(!1),[ez,eG]=(0,s.useState)(!1),{isOnline:e_}=er(),eV={lat:30.2672,lng:-97.7431};(0,s.useEffect)(()=>{(async()=>{try{await en.init();let e=await en.getPins(),t=await en.getFollowUps(),r=await en.getCustomers();e.length>0&&(T(e),B(new Set(e.map(e=>e.address)))),t.length>0&&ev(t),r.length>0&&ef(r);let a=await ek.getTerritories();a.length>0&&(eS(a),eP(new Set(a.map(e=>e.id)))),console.log("Loaded cached data:",{pins:e.length,followUps:t.length,customers:r.length,territories:a.length})}catch(e){console.error("Error initializing offline storage:",e)}})()},[]),(0,s.useEffect)(()=>{(async()=>{if(!e_){W("You're offline. Maps functionality is limited.");return}try{let e=await el();if(!e.hasValidKey){W(e.error||"Failed to load Google Maps configuration");return}if(window.google&&window.google.maps){console.log("Google Maps already loaded"),eG(!0),eH();return}let t=document.createElement("script");return t.src=e.scriptUrl,t.async=!0,t.defer=!0,t.onerror=e=>{console.error("Google Maps script loading error:",e),W("Failed to load Google Maps. Please check your internet connection and API key.")},t.onload=()=>{console.log("Google Maps script loaded successfully"),eG(!0)},window.initMap=()=>{try{console.log("Initializing Google Maps..."),eH()}catch(e){console.error("Map initialization error:",e),W("Failed to initialize Google Maps. Please check your API key permissions.")}},document.head.appendChild(t),()=>{document.head.contains(t)&&document.head.removeChild(t)}}catch(e){console.error("Error initializing Google Maps:",e),W("Failed to initialize Google Maps configuration.")}})()},[e_]),(0,s.useEffect)(()=>{if(P&&R.length>0){L.forEach(e=>{e.marker&&e.marker.setMap(null)}),F([]);let e=[];R.forEach(t=>{try{let r=eW(t,P);e.push({id:t.id,marker:r})}catch(e){console.error("Error creating marker for pin:",t.id,e)}}),F(e),console.log("Added ".concat(e.length," markers to map"))}},[P,R.length]),(0,s.useEffect)(()=>{e_&&eZ()},[e_]);let eZ=async()=>{try{let e=await en.getOfflineData();(e.pins.length>0||e.followUps.length>0||e.customers.length>0)&&((0,D.oR)({title:"Syncing offline data...",description:"Syncing ".concat(e.pins.length," pins, ").concat(e.followUps.length," follow-ups, and ").concat(e.customers.length," customers")}),setTimeout(async()=>{await en.markAsSynced("pins",e.pins.map(e=>e.id)),await en.markAsSynced("followUps",e.followUps.map(e=>e.id)),await en.markAsSynced("customers",e.customers.map(e=>e.pinId)),(0,D.oR)({title:"Sync complete!",description:"All offline data has been synchronized"})},2e3))}catch(e){console.error("Error syncing offline data:",e)}},eH=()=>{if(!E.current){console.error("Map container not found");return}if(!window.google||!window.google.maps){console.error("Google Maps not loaded"),W("Google Maps failed to load. Please refresh the page.");return}try{let e=new window.google.maps.Map(E.current,{center:eV,zoom:12,mapTypeId:"satellite",gestureHandling:"greedy",mapTypeControl:!1,fullscreenControl:!1,streetViewControl:!1,zoomControl:!0,rotateControl:!0,rotateControlOptions:{position:window.google.maps.ControlPosition.TOP_LEFT},tilt:0,minZoom:3,maxZoom:22,restriction:{strictBounds:!1},styles:[{featureType:"all",elementType:"labels",stylers:[{visibility:"off"}]}]});if(M(e),window.google.maps.drawing)try{let t=new window.google.maps.drawing.DrawingManager({drawingMode:null,drawingControl:!0,drawingControlOptions:{position:window.google.maps.ControlPosition.TOP_CENTER,drawingModes:[window.google.maps.drawing.OverlayType.POLYGON]},polygonOptions:{editable:!0,fillColor:"#3b82f6",fillOpacity:.3,strokeColor:"#3b82f6",strokeWeight:2}});t.setMap(e),eD(t),t.addListener("polygoncomplete",e=>{try{let r=e.getPath().getArray().map(e=>({lat:e.lat(),lng:e.lng()}));eL(r),eR(!0),eI(!1),t.setDrawingMode(null),e.setMap(null)}catch(e){console.error("Error handling polygon completion:",e),(0,D.oR)({title:"Error",description:"Failed to create territory. Please try again.",variant:"destructive"})}}),t.addListener("drawingmode_changed",()=>{try{let e=t.getDrawingMode();eI(e===window.google.maps.drawing.OverlayType.POLYGON)}catch(e){console.error("Error handling drawing mode change:",e)}}),console.log("Drawing Manager initialized successfully")}catch(e){console.error("Error initializing Drawing Manager:",e),(0,D.oR)({title:"Warning",description:"Territory drawing tools are not available. Basic map functionality will work."})}else console.warn("Google Maps Drawing library not available"),(0,D.oR)({title:"Warning",description:"Territory drawing tools are not available. Please check your API configuration."});e.addListener("click",t=>{(null==t?void 0:t.latLng)&&!eO&&eK(t.latLng,e).catch(e=>{console.error("Map click handler error:",e)})}),e.addListener("zoom_changed",()=>{e.getTilt&&0!==e.getTilt()&&e.setTilt(0)}),e.addListener("tilt_changed",()=>{e.getTilt&&0!==e.getTilt()&&e.setTilt(0)}),console.log("Map initialized successfully")}catch(e){console.error("Failed to initialize map:",e),W("Failed to initialize Google Maps. Please refresh the page and try again.")}},eY=e=>{switch(e){case"not-interested":return"#ef4444";case"not-home":return"#eab308";case"follow-up":return"#3b82f6";case"onboarded":return"#22c55e";default:return"#6b7280"}},eW=(e,t)=>{if(!window.google||!window.google.maps)throw Error("Google Maps not available");let r=new window.google.maps.Marker({position:{lat:e.lat,lng:e.lng},map:t,title:e.address,icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:10,fillColor:eY(e.status),fillOpacity:1,strokeColor:e.offline?"#ff6b6b":"#ffffff",strokeWeight:e.offline?3:2}});return r.addListener("click",()=>{console.log("Marker clicked, opening modal"),O(e),eX(e.lat,e.lng)}),r},eJ=(e,t)=>{let r=L.find(t=>t.id===e);if(r&&window.google&&window.google.maps){let a=R.find(t=>t.id===e);r.marker.setIcon({path:window.google.maps.SymbolPath.CIRCLE,scale:10,fillColor:eY(t),fillOpacity:1,strokeColor:(null==a?void 0:a.offline)?"#ff6b6b":"#ffffff",strokeWeight:(null==a?void 0:a.offline)?3:2})}},eK=async(e,t)=>{console.log("Map clicked at:",e.lat(),e.lng()),$("Processing click...");let r=e.lat(),a=e.lng();_(!0);try{let e="".concat(r.toFixed(6),", ").concat(a.toFixed(6)),t="";if(e_&&window.google&&window.google.maps){$("Getting address...");try{let s=new window.google.maps.Geocoder,l=await new Promise((e,t)=>{let l=setTimeout(()=>t(Error("Geocoding timeout")),5e3);s.geocode({location:{lat:r,lng:a}},(r,a)=>{clearTimeout(l),"OK"===a&&r&&r[0]?e(r[0]):t(Error("Geocoding failed: ".concat(a)))})});e=l.formatted_address||e,t=l.place_id||"",console.log("Geocoding successful:",e)}catch(e){console.warn("Geocoding failed, using coordinates:",e)}}else $("Offline - using coordinates...");if(q.has(e)){(0,D.oR)({title:"Duplicate Location",description:"This address already has a pin!",variant:"destructive"});return}$("Creating pin...");let s={id:Date.now().toString(),lat:r,lng:a,address:e,placeId:t,propertyName:"",status:"new",createdAt:new Date,updatedAt:new Date,timestamp:new Date,offline:!e_};console.log("Created pin:",s);try{await eq.createPin({id:s.id,lat:s.lat,lng:s.lng,address:s.address,placeId:s.placeId,propertyName:s.propertyName,status:s.status}),console.log("Pin saved to database")}catch(e){console.error("Failed to save pin to database:",e)}if(await en.savePin(s),P)try{let e=eW(s,P);F(t=>[...t,{id:s.id,marker:e}]),console.log("Marker added successfully")}catch(e){console.error("Failed to create marker:",e)}T(e=>[...e,s]),B(t=>new Set([...t,e]));try{let e=e6(s);e.length>0&&(0,D.oR)({title:"Pin in Territory",description:"This location is in: ".concat(e.map(e=>e.name).join(", "))})}catch(e){console.error("Error checking territories:",e)}console.log("Opening modal for new pin"),O(s),eX(r,a),$(e_?"Pin created successfully!":"Pin saved offline!")}catch(t){console.error("Error in handleMapClick:",t),$("Error: ".concat(t.message));let e={id:Date.now().toString(),lat:r,lng:a,address:"".concat(r.toFixed(6),", ").concat(a.toFixed(6)),status:"new",createdAt:new Date,updatedAt:new Date,timestamp:new Date,offline:!e_};try{try{await eq.createPin({id:e.id,lat:e.lat,lng:e.lng,address:e.address,status:e.status}),console.log("Fallback pin saved to database")}catch(e){console.error("Failed to save fallback pin to database:",e)}await en.savePin(e),T(t=>[...t,e]),O(e),eX(r,a)}catch(e){console.error("Error saving fallback pin:",e),(0,D.oR)({title:"Error",description:"Failed to save location. Please try again.",variant:"destructive"})}}finally{_(!1)}},eX=async(e,t)=>{if(!e_){z("/placeholder.svg?height=300&width=600");return}try{let r=0;if(window.google&&window.google.maps)try{let a=new window.google.maps.StreetViewService,s=await new Promise((r,s)=>{let l=setTimeout(()=>s(Error("Street View timeout")),5e3);a.getPanorama({location:{lat:e,lng:t},radius:50,source:window.google.maps.StreetViewSource.OUTDOOR},(e,t)=>{clearTimeout(l),"OK"===t&&e?r(e):s(Error("Street View not available: ".concat(t)))})});if(s&&s.location&&window.google.maps.geometry){let a=s.location.latLng;r=window.google.maps.geometry.spherical.computeHeading(a,{lat:e,lng:t})}}catch(e){console.warn("Street View Service failed, using default heading:",e)}let a=await eo(e,t,r);z(a),console.log("Street View URL generated")}catch(e){console.error("Failed to load street view:",e),z("/placeholder.svg?height=300&width=600")}},e$=async(e,t)=>{let r=R.map(r=>r.id===e?{...r,status:t,updatedAt:new Date,offline:!e_}:r);T(r);try{await eq.updatePinStatus(e,t),console.log("Pin status updated in database")}catch(e){console.error("Failed to update pin status in database:",e)}let a=r.find(t=>t.id===e);a&&await en.savePin(a),eJ(e,t),O(null)},eQ=async e=>{try{let t=await eU.saveFollowUp(e);ev(t=>[...t,e]),U&&e$(U.id,"follow-up"),ed(!1),(0,D.oR)({title:"Follow-up Scheduled!",description:"Appointment saved to database for ".concat(new Date(e.date).toLocaleDateString()," at ").concat(e.time)}),console.log("Follow-up saved to database:",t)}catch(t){if(console.error("Error saving follow-up:",t),e_)(0,D.oR)({title:"Error",description:"Failed to save follow-up. Please try again.",variant:"destructive"});else{let t={...e,offline:!0};await en.saveFollowUp(t),ev(e=>[...e,t]),U&&e$(U.id,"follow-up"),ed(!1),(0,D.oR)({title:"Follow-up Scheduled Offline",description:"Your follow-up has been saved locally and will sync when online."})}}},e0=()=>{ei(!0)},e4=async e=>{try{let t=await eB.w.saveOnboardData({firstName:e.firstName,phone:e.phone,email:e.email,ownsCrypto:e.ownsCrypto,socials:e.socials,notes:e.notes,pinId:e.pinId,address:e.address,timestamp:e.timestamp});U&&e$(U.id,"onboarded");let r={...e,offline:!1};ef(e=>[...e,r]),eh(r),ei(!1),em(!0),(0,D.oR)({title:"Success!",description:"".concat(e.firstName," has been successfully onboarded and saved to database!")}),console.log("Customer saved to database:",t)}catch(t){if(console.error("Error saving customer:",t),e_)(0,D.oR)({title:"Error",description:"Failed to onboard customer. Please try again.",variant:"destructive"});else{let t={...e,offline:!0};await en.saveCustomer(t),ef(e=>[...e,t]),eh(t),U&&e$(U.id,"onboarded"),ei(!1),em(!0),(0,D.oR)({title:"Customer Onboarded Offline",description:"Customer has been saved locally and will sync when online."})}}},e1=()=>{P&&window.google&&window.google.maps&&(eC.forEach(e=>{try{e.setMap(null)}catch(e){console.error("Error clearing polygon:",e)}}),eA(eN.filter(e=>eE.has(e.id)).map(e=>{try{let t=new window.google.maps.Polygon({paths:e.coordinates,fillColor:e.color,fillOpacity:.2,strokeColor:e.color,strokeWeight:2,map:P}),r=new window.google.maps.InfoWindow({content:'<div class="p-2"><strong>'.concat(e.name,"</strong><br/><small>").concat(e.coordinates.length," points</small></div>")});return t.addListener("click",e=>{try{r.setPosition(e.latLng),r.open(P)}catch(e){console.error("Error opening info window:",e)}}),t}catch(e){return console.error("Error creating territory polygon:",e),null}}).filter(Boolean)))},e2=async(e,t)=>{try{let r={id:Date.now().toString(),name:e,color:t,coordinates:eT,createdAt:new Date,updatedAt:new Date};await ek.saveTerritory(r),eS(e=>[...e,r]),eP(e=>new Set([...e,r.id])),eR(!1),eL([]),(0,D.oR)({title:"Territory Created!",description:'"'.concat(e,'" has been created successfully.')})}catch(e){console.error("Error creating territory:",e),(0,D.oR)({title:"Error",description:"Failed to create territory. Please try again.",variant:"destructive"})}},e5=async e=>{try{await ek.updateTerritory(e),eS(t=>t.map(t=>t.id===e.id?e:t))}catch(e){console.error("Error updating territory:",e),(0,D.oR)({title:"Error",description:"Failed to update territory. Please try again.",variant:"destructive"})}},e3=async e=>{try{await ek.deleteTerritory(e),eS(t=>t.filter(t=>t.id!==e)),eP(t=>{let r=new Set(t);return r.delete(e),r})}catch(e){console.error("Error deleting territory:",e),(0,D.oR)({title:"Error",description:"Failed to delete territory. Please try again.",variant:"destructive"})}},e6=e=>{try{var t;let r=(t={lat:e.lat,lng:e.lng},eN.filter(e=>(function(e,t){try{let r=function(e){if(e.length<3)throw Error("Polygon must have at least 3 coordinates");let t=e.map(e=>[e.lng,e.lat]);return(t[0][0]!==t[t.length-1][0]||t[0][1]!==t[t.length-1][1])&&t.push(t[0]),{type:"Feature",geometry:{type:"Polygon",coordinates:[t]},properties:{}}}(t.coordinates),a={type:"Feature",geometry:{type:"Point",coordinates:[e.lng,e.lat]},properties:{}};return function(e,t){let[r,a]=e,s=!1;for(let e=0,l=t.length-1;e<t.length;l=e++){let[o,i]=t[e],[n,c]=t[l];i>a!=c>a&&r<(n-o)*(a-i)/(c-i)+o&&(s=!s)}return s}(a.geometry.coordinates,r.geometry.coordinates[0])}catch(e){return console.error("Error checking point in territory:",e),!1}})(t,e)));return r.length>0&&console.log("Pin at ".concat(e.address," is in territories:"),r.map(e=>e.name)),r}catch(e){return console.error("Error checking pin territories:",e),[]}};return(0,s.useEffect)(()=>{P&&eN.length>0&&ez&&e1()},[P,eN,eE,ez]),(0,a.jsxs)("div",{className:"h-screen flex flex-col bg-gradient-to-br from-purple-50 via-blue-50 to-pink-50 overflow-hidden touch-pan-y",children:[(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm shadow-sm border-b border-purple-100 p-3 sm:p-4 flex-shrink-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h1",{className:"text-lg sm:text-2xl font-bold bg-gradient-to-r from-purple-600 via-blue-600 to-pink-600 bg-clip-text text-transparent truncate flex-1 min-w-0",children:"PulseChain Education Tracker"}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[e_?(0,a.jsx)(j.A,{className:"h-4 w-4 text-green-600"}):(0,a.jsx)(N.A,{className:"h-4 w-4 text-red-600"}),(0,a.jsx)("span",{className:"text-xs text-gray-600 hidden sm:inline",children:e_?"Online":"Offline"})]})]}),(0,a.jsxs)("div",{className:"hidden md:flex items-center gap-3",children:[(0,a.jsxs)(g,{variant:"outline",className:"flex items-center gap-1 border-purple-200 text-purple-700",children:[(0,a.jsx)(y.A,{className:"h-3 w-3"}),R.length," Doors Knocked"]}),X&&(0,a.jsx)(g,{variant:"outline",className:"text-xs border-blue-200 text-blue-700 max-w-32 truncate",children:X}),eO&&(0,a.jsx)(g,{variant:"outline",className:"text-xs border-green-200 text-green-700",children:"Drawing Mode Active"})]}),(0,a.jsxs)("div",{className:"flex md:hidden items-center gap-2",children:[(0,a.jsxs)(g,{variant:"outline",className:"flex items-center gap-1 border-purple-200 text-purple-700 text-xs",children:[(0,a.jsx)(y.A,{className:"h-3 w-3"}),R.length]}),(0,a.jsx)(d,{variant:"outline",size:"sm",onClick:()=>ej(!ey),className:"border-purple-200 text-purple-700 hover:bg-purple-50",children:(0,a.jsx)(S.A,{className:"h-4 w-4"})})]})]}),ey&&(0,a.jsx)("div",{className:"md:hidden mt-3 p-3 bg-white/90 backdrop-blur-sm rounded-lg border border-purple-200 shadow-lg",children:(0,a.jsx)("div",{className:"space-y-2",children:X&&(0,a.jsx)(g,{variant:"outline",className:"w-full text-xs border-blue-200 text-blue-700 justify-center truncate",children:X})})})]}),(0,a.jsxs)("div",{className:"flex-1 relative min-h-0 touch-none",children:[Y?(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-purple-100 via-blue-100 to-pink-100 p-4",children:(0,a.jsxs)(p,{className:"max-w-md w-full border-purple-200 shadow-lg",children:[(0,a.jsx)(m,{children:(0,a.jsxs)(u,{className:"text-red-600 text-lg flex items-center gap-2",children:[!e_&&(0,a.jsx)(N.A,{className:"h-5 w-5"}),e_?"Google Maps Error":"Offline Mode"]})}),(0,a.jsxs)(h,{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-gray-700 text-sm",children:Y}),e_?(0,a.jsxs)("div",{className:"bg-purple-50 p-3 rounded-lg border border-purple-200",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2 text-sm",children:"To fix this issue:"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-xs",children:[(0,a.jsxs)("li",{children:["Go to"," ",(0,a.jsx)("a",{href:"https://console.cloud.google.com/",target:"_blank",rel:"noopener noreferrer",className:"text-purple-600 hover:underline",children:"Google Cloud Console"})]}),(0,a.jsx)("li",{children:"Create a new project or select an existing one"}),(0,a.jsxs)("li",{children:["Enable the following APIs:",(0,a.jsxs)("ul",{className:"list-disc list-inside ml-4 mt-1",children:[(0,a.jsx)("li",{children:"Maps JavaScript API"}),(0,a.jsx)("li",{children:"Geocoding API"}),(0,a.jsx)("li",{children:"Street View Static API"}),(0,a.jsx)("li",{children:"Maps Drawing API"})]})]}),(0,a.jsx)("li",{children:'Create an API key in "Credentials"'}),(0,a.jsx)("li",{children:"Add the API key to your environment variables"}),(0,a.jsx)("li",{children:"Restart your development server"})]})]}):(0,a.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2 text-sm",children:"Available offline features:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[(0,a.jsx)("li",{children:"View cached locations and data"}),(0,a.jsx)("li",{children:"Add new pins (will sync when online)"}),(0,a.jsx)("li",{children:"Schedule follow-ups"}),(0,a.jsx)("li",{children:"Onboard customers"}),(0,a.jsx)("li",{children:"View calendar"})]})]})]})]})}):(0,a.jsx)("div",{ref:E,className:"w-full h-full touch-none"}),!Y&&(0,a.jsxs)(d,{onClick:()=>{if(!navigator.geolocation){(0,D.oR)({title:"Geolocation Not Supported",description:"Your browser doesn't support geolocation.",variant:"destructive"});return}Z(!0),navigator.geolocation.getCurrentPosition(e=>{let{latitude:t,longitude:r}=e.coords,a={lat:t,lng:r};et(a),P&&window.google&&window.google.maps&&(P.setCenter(a),P.setZoom(16),new window.google.maps.Marker({position:a,map:P,title:"Your Location",icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:8,fillColor:"#8b5cf6",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:3}}),console.log("GPS location found:",a)),Z(!1)},e=>{console.error("GPS error:",e);let t="Unable to get your location. ";switch(e.code){case e.PERMISSION_DENIED:t+="Location access was denied. Please enable location permissions.";break;case e.POSITION_UNAVAILABLE:t+="Location information is unavailable.";break;case e.TIMEOUT:t+="Location request timed out.";break;default:t+="An unknown error occurred."}(0,D.oR)({title:"Location Error",description:t,variant:"destructive"}),Z(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},disabled:V,className:"absolute top-3 right-3 z-10 bg-white/90 backdrop-blur-sm text-purple-700 border border-purple-200 hover:bg-purple-50 shadow-lg",size:"sm",children:[V?(0,a.jsx)(k.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(C.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline ml-2",children:V?"Getting Location...":"My Location"})]}),G&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center p-4",children:(0,a.jsx)("div",{className:"bg-white/90 backdrop-blur-sm p-4 rounded-lg border border-purple-200 shadow-lg max-w-xs w-full text-center",children:(0,a.jsx)("p",{className:"text-purple-700 text-sm",children:e_?"Loading address information...":"Saving location offline..."})})}),U&&!es&&!ec&&!ep&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:e=>{e.target===e.currentTarget&&O(null)},children:(0,a.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,a.jsx)(J.Z,{spread:40,glow:!0,disabled:!1,proximity:64,inactiveZone:.01}),(0,a.jsxs)(p,{className:"bg-white/95 backdrop-blur-sm border-purple-200 shadow-xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(m,{children:(0,a.jsxs)(u,{className:"flex items-center gap-2 text-purple-700 text-lg",children:[(e=>{switch(e){case"not-home":return(0,a.jsx)(f.A,{className:"h-4 w-4"});case"not-interested":return(0,a.jsx)(b.A,{className:"h-4 w-4"});case"follow-up":return(0,a.jsx)(w.A,{className:"h-4 w-4"});case"onboarded":return(0,a.jsx)(v.A,{className:"h-4 w-4"});default:return(0,a.jsx)(y.A,{className:"h-4 w-4"})}})(U.status),"Location Details",U.offline&&(0,a.jsx)(g,{variant:"outline",className:"text-xs border-orange-200 text-orange-700",children:"Offline"})]})}),(0,a.jsxs)(h,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[U.propertyName&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Property:"}),(0,a.jsx)("p",{className:"font-semibold text-base break-words",children:U.propertyName})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"Address:"}),(0,a.jsx)("p",{className:"font-medium text-sm break-words",children:U.address}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1 break-all",children:[U.lat.toFixed(6),", ",U.lng.toFixed(6)]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Street View:"}),(0,a.jsx)("img",{src:I||"/placeholder.svg?height=300&width=600",alt:"Street view",className:"w-full h-40 sm:h-48 object-cover rounded-lg border border-purple-200 shadow-sm",onError:e=>{e.target.src="/placeholder.svg?height=300&width=600"}}),!e_&&(0,a.jsx)("p",{className:"text-xs text-orange-600 mt-1",children:"Street View unavailable offline"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(d,{variant:"outline",size:"sm",onClick:()=>e$(U.id,"not-home"),className:"flex items-center gap-1 border-yellow-300 text-yellow-700 hover:bg-yellow-50 text-xs",children:[(0,a.jsx)(f.A,{className:"h-3 w-3"}),"Not Home"]}),(0,a.jsxs)(d,{variant:"outline",size:"sm",onClick:()=>e$(U.id,"not-interested"),className:"flex items-center gap-1 border-red-300 text-red-700 hover:bg-red-50 text-xs",children:[(0,a.jsx)(b.A,{className:"h-3 w-3"}),"Not Interested"]}),(0,a.jsxs)(d,{variant:"outline",size:"sm",onClick:()=>{ed(!0)},className:"flex items-center gap-1 border-blue-300 text-blue-700 hover:bg-blue-50 bg-transparent text-xs",children:[(0,a.jsx)(w.A,{className:"h-3 w-3"}),"Follow-up"]}),(0,a.jsxs)(d,{variant:"outline",size:"sm",onClick:e0,className:"flex items-center gap-1 border-green-300 text-green-700 hover:bg-green-50 bg-transparent text-xs",children:[(0,a.jsx)(v.A,{className:"h-3 w-3"}),"Onboarded"]})]}),(0,a.jsxs)(d,{className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-sm",onClick:e0,children:[(0,a.jsx)(A.A,{className:"h-4 w-4 mr-2"}),"Create New Onboard"]}),(0,a.jsx)(d,{variant:"outline",className:"w-full bg-transparent border-purple-200 text-purple-700 hover:bg-purple-50 text-sm",onClick:()=>{console.log("Closing modal"),O(null)},children:"Close"})]})]})]})}),ec&&U&&(0,a.jsx)(K,{pin:U,onSave:eQ,onCancel:()=>{ed(!1)}}),t&&(0,a.jsx)(ee,{followUps:ew,onClose:()=>{r(!1);let e=new URLSearchParams(window.location.search);e.delete("view");let t=e.toString()?"/?".concat(e.toString()):"/";x.replace(t)}}),es&&U&&(0,a.jsx)(H,{pin:U,onSubmit:e4,onCancel:()=>{ei(!1)}}),ep&&eu&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,a.jsx)(J.Z,{spread:40,glow:!0,disabled:!1,proximity:64,inactiveZone:.01}),(0,a.jsxs)(p,{className:"bg-white/95 backdrop-blur-sm border-purple-200 shadow-xl",children:[(0,a.jsx)(m,{children:(0,a.jsxs)(u,{className:"flex items-center gap-2 text-green-600 text-lg",children:[(0,a.jsx)(v.A,{className:"h-6 w-6"}),"Onboarding Complete!",eu.offline&&(0,a.jsx)(g,{variant:"outline",className:"text-xs border-orange-200 text-orange-700",children:"Saved Offline"})]})}),(0,a.jsxs)(h,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-lg font-semibold break-words",children:eu.firstName}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"has been successfully onboarded"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1 break-words",children:eu.address}),eu.offline&&(0,a.jsx)("p",{className:"text-xs text-orange-600 mt-1",children:"Data will sync when online"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(d,{variant:"outline",className:"flex-1 bg-transparent border-purple-200 text-purple-700 hover:bg-purple-50 text-sm",onClick:()=>{em(!1),O(null),eh(null)},children:"Back To Map"}),(0,a.jsx)(d,{className:"flex-1 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-sm",onClick:()=>{em(!1),O(null),alert("Viewing profile for ".concat(null==eu?void 0:eu.firstName)),eh(null)},children:"View Profile"})]})]})]})]})})]}),o&&(0,a.jsx)(ex,{territories:eN,onClose:()=>{i(!1);let e=new URLSearchParams(window.location.search);e.delete("view");let t=e.toString()?"/?".concat(e.toString()):"/";x.replace(t)},onUpdateTerritory:e5,onDeleteTerritory:e3,onToggleTerritoryVisibility:e=>{eP(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})},visibleTerritories:eE}),eM&&(0,a.jsx)(eb,{coordinates:eT,onSave:e2,onCancel:()=>{eR(!1),eL([])}}),(0,a.jsx)(ea,{})]})}function eW(){let[e,t]=(0,s.useState)(!1),[r,l]=(0,s.useState)(!1),[o,i]=(0,s.useState)(!1);return(0,a.jsxs)("div",{children:[(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{children:"Loading..."}),children:(0,a.jsx)(eH,{setShowCalendarView:t,setShowTerritoryManager:l,setIsModalTransitioning:i})}),(0,a.jsx)(eY,{showCalendarView:e,setShowCalendarView:t,showTerritoryManager:r,setShowTerritoryManager:l,isModalTransitioning:o,setIsModalTransitioning:i})]})}},2477:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var a=r(8081),s=r(2149),l=r(7687),o=r(4330);let i=(0,s.memo)(e=>{let{blur:t=0,inactiveZone:r=.7,proximity:i=0,spread:n=20,variant:c="default",glow:d=!1,className:p,movementDuration:m=2,borderWidth:u=1,disabled:h=!0}=e,x=(0,s.useRef)(null),g=(0,s.useRef)({x:0,y:0}),f=(0,s.useRef)(0),b=(0,s.useCallback)(e=>{x.current&&(f.current&&cancelAnimationFrame(f.current),f.current=requestAnimationFrame(()=>{var t,a;let s=x.current;if(!s)return;let{left:l,top:n,width:c,height:d}=s.getBoundingClientRect(),p=null!==(t=null==e?void 0:e.x)&&void 0!==t?t:g.current.x,u=null!==(a=null==e?void 0:e.y)&&void 0!==a?a:g.current.y;e&&(g.current={x:p,y:u});let h=[l+.5*c,n+.5*d];if(Math.hypot(p-h[0],u-h[1])<.5*Math.min(c,d)*r){s.style.setProperty("--active","0");return}let f=p>l-i&&p<l+c+i&&u>n-i&&u<n+d+i;if(s.style.setProperty("--active",f?"1":"0"),!f)return;let b=parseFloat(s.style.getPropertyValue("--start"))||0,w=(180*Math.atan2(u-h[1],p-h[0])/Math.PI+90-b+180)%360-180;(0,o.i)(b,b+w,{duration:m,ease:[.16,1,.3,1],onUpdate:e=>{s.style.setProperty("--start",String(e))}})}))},[r,i,m]);return(0,s.useEffect)(()=>{if(h)return;let e=()=>b(),t=e=>b(e);return window.addEventListener("scroll",e,{passive:!0}),document.body.addEventListener("pointermove",t,{passive:!0}),()=>{f.current&&cancelAnimationFrame(f.current),window.removeEventListener("scroll",e),document.body.removeEventListener("pointermove",t)}},[b,h]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:(0,l.cn)("pointer-events-none absolute -inset-px hidden rounded-[inherit] border opacity-0 transition-opacity",d&&"opacity-100","white"===c&&"border-white",h&&"!block")}),(0,a.jsx)("div",{ref:x,style:{"--blur":"".concat(t,"px"),"--spread":n,"--start":"0","--active":"0","--glowingeffect-border-width":"".concat(u,"px"),"--repeating-conic-gradient-times":"5","--gradient":"white"===c?"repeating-conic-gradient(\n                  from 236.84deg at 50% 50%,\n                  var(--black),\n                  var(--black) calc(25% / var(--repeating-conic-gradient-times))\n                )":"radial-gradient(circle, #dd7bbb 10%, #dd7bbb00 20%),\n                radial-gradient(circle at 40% 40%, #d79f1e 5%, #d79f1e00 15%),\n                radial-gradient(circle at 60% 60%, #5a922c 10%, #5a922c00 20%), \n                radial-gradient(circle at 40% 60%, #4c7894 10%, #4c789400 20%),\n                repeating-conic-gradient(\n                  from 236.84deg at 50% 50%,\n                  #dd7bbb 0%,\n                  #d79f1e calc(25% / var(--repeating-conic-gradient-times)),\n                  #5a922c calc(50% / var(--repeating-conic-gradient-times)), \n                  #4c7894 calc(75% / var(--repeating-conic-gradient-times)),\n                  #dd7bbb calc(100% / var(--repeating-conic-gradient-times))\n                )"},className:(0,l.cn)("pointer-events-none absolute inset-0 rounded-[inherit] opacity-100 transition-opacity",d&&"opacity-100",t>0&&"blur-[var(--blur)] ",p,h&&"!hidden"),children:(0,a.jsx)("div",{className:(0,l.cn)("glow","rounded-[inherit]",'after:content-[""] after:rounded-[inherit] after:absolute after:inset-[calc(-1*var(--glowingeffect-border-width))]',"after:[border:var(--glowingeffect-border-width)_solid_transparent]","after:[background:var(--gradient)] after:[background-attachment:fixed]","after:opacity-[var(--active)] after:transition-opacity after:duration-300","after:[mask-clip:padding-box,border-box]","after:[mask-composite:intersect]","after:[mask-image:linear-gradient(#0000,#0000),conic-gradient(from_calc((var(--start)-var(--spread))*1deg),#00000000_0deg,#fff,#00000000_calc(var(--spread)*2deg))]")})})]})});i.displayName="GlowingEffect"},3031:(e,t,r)=>{Promise.resolve().then(r.bind(r,2177))},3928:(e,t,r)=>{"use strict";r.d(t,{c:()=>s});var a=r(3345);let s=(0,a.createServerReference)("40f34cf53a1224b3253e5980ce9652ace35481a305",a.callServer,void 0,a.findSourceMapURL,"createPin")},5844:(e,t,r)=>{"use strict";r.d(t,{dj:()=>m,oR:()=>p});var a=r(2149);let s=0,l=new Map,o=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?o(r):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},n=[],c={toasts:[]};function d(e){c=i(c,e),n.forEach(e=>{e(c)})}function p(e){let{...t}=e,r=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>d({type:"DISMISS_TOAST",toastId:r});return d({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function m(){let[e,t]=a.useState(c);return a.useEffect(()=>(n.push(t),()=>{let e=n.indexOf(t);e>-1&&n.splice(e,1)}),[e]),{...e,toast:p,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},6831:(e,t,r)=>{"use strict";r.d(t,{t:()=>s});var a=r(3345);let s=(0,a.createServerReference)("604cff86cd50f693c8e42b6b8daf7313e61764fe3f",a.callServer,void 0,a.findSourceMapURL,"updatePinStatus")},7186:(e,t,r)=>{"use strict";r.d(t,{w:()=>h});var a=r(3345);let s=(0,a.createServerReference)("40ac42374f9a46a1df78a458f6f4e10e45e4698e5b",a.callServer,void 0,a.findSourceMapURL,"createCustomer"),l=(0,a.createServerReference)("00712e5c9e112a6647018f4f8b4ca2d66c7cb4112b",a.callServer,void 0,a.findSourceMapURL,"getAllCustomers"),o=(0,a.createServerReference)("409c19e64ec99ea8a4caf3e8cf8a69a1b7ddbda215",a.callServer,void 0,a.findSourceMapURL,"getCustomer"),i=(0,a.createServerReference)("409f18f97b054ceb3a1d7fa30a1ae158ab0d2e4189",a.callServer,void 0,a.findSourceMapURL,"getCustomerByPinId"),n=(0,a.createServerReference)("40b28159295fe987b57870d19b8e99b4c198fca5c8",a.callServer,void 0,a.findSourceMapURL,"updateCustomer"),c=(0,a.createServerReference)("40edfb554ffc2f4a054fdd4ca6498fd99b39071d21",a.callServer,void 0,a.findSourceMapURL,"deleteCustomer"),d=(0,a.createServerReference)("403bf1e5d088d6a04aed921b8bfc71258983d09842",a.callServer,void 0,a.findSourceMapURL,"deleteCustomerByPinId"),p=(0,a.createServerReference)("408f939bedfe9f3e39cd7c19621057299c9af63be4",a.callServer,void 0,a.findSourceMapURL,"saveCustomer"),m=(0,a.createServerReference)("4027d79fa448c59c031b694594791dffb266b2ed84",a.callServer,void 0,a.findSourceMapURL,"saveCustomerByPinId");class u{async createCustomer(e){try{return await s(e)}catch(e){throw console.error("Error creating customer:",e),e}}async getAllCustomers(){try{return await l()}catch(e){throw console.error("Error loading customers:",e),e}}async getCustomer(e){try{return await o(e)}catch(e){throw console.error("Error loading customer:",e),e}}async getCustomerByPinId(e){try{return await i(e)}catch(e){throw console.error("Error loading customer by pin ID:",e),e}}async updateCustomer(e){try{return await n(e)}catch(e){throw console.error("Error updating customer:",e),e}}async deleteCustomer(e){try{await c(e)}catch(e){throw console.error("Error deleting customer:",e),e}}async deleteCustomerByPinId(e){try{await d(e)}catch(e){throw console.error("Error deleting customer by pin ID:",e),e}}async saveCustomer(e){try{await p(e)}catch(e){throw console.error("Error saving customer:",e),e}}async saveOnboardData(e){try{let t=await r.e(935).then(r.bind(r,1935)),a=await t.getPin(e.pinId);if(!a)try{a=await t.createPin({id:e.pinId,lat:0,lng:0,address:e.address,placeId:"",propertyName:"",status:"new"}),console.log("Pin created in database for customer:",a)}catch(e){throw console.error("Failed to create pin in database:",e),Error("Unable to create pin reference for customer")}let s={id:"customer-".concat(Date.now()),pinId:e.pinId,firstName:e.firstName,phone:e.phone,email:e.email,ownsCrypto:e.ownsCrypto||!1,socials:e.socials,notes:e.notes,address:e.address,createdAt:e.timestamp||new Date,updatedAt:new Date};return await m(s)}catch(e){throw console.error("Error saving onboard data:",e),e}}}let h=new u},7687:(e,t,r)=>{"use strict";r.d(t,{cn:()=>l});var a=r(6522),s=r(4483);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}},8166:(e,t,r)=>{"use strict";r.d(t,{i:()=>s});var a=r(3345);let s=(0,a.createServerReference)("40f05baf1df05e97cad796705dc11e8e239525e321",a.callServer,void 0,a.findSourceMapURL,"getPin")},9148:(e,t,r)=>{"use strict";r.d(t,{I:()=>s});var a=r(3345);let s=(0,a.createServerReference)("00fb8a0b5f97d6aff80fb5f2dbe620e93a72b8abf4",a.callServer,void 0,a.findSourceMapURL,"getAllPins")},9323:(e,t,r)=>{"use strict";r.d(t,{H:()=>s});var a=r(3345);let s=(0,a.createServerReference)("40b4819b2b22612ed7644a79ccde8753d5decc2e37",a.callServer,void 0,a.findSourceMapURL,"updatePin")}},e=>{var t=t=>e(e.s=t);e.O(0,[126,13,315,808,497,954,358],()=>t(3031)),_N_E=e.O()}]);